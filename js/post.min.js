"use strict";(()=>{const e={supportsFullScreen:!1,isFullScreen:()=>!1,requestFullScreen:()=>{},cancelFullScreen:()=>{},fullScreenEventName:"",prefix:""},t="webkit moz o ms khtml".split(" ");if(void 0===document.cancelFullScreen){for(let r=0,n=t.length;r<n;r++)if(e.prefix=t[r],void 0!==document[`${e.prefix}CancelFullScreen`]){e.supportsFullScreen=!0;break}}else e.supportsFullScreen=!0;e.supportsFullScreen&&(e.fullScreenEventName=`${e.prefix}fullscreenchange`,e.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[`${this.prefix}FullScreen`]}},e.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[`${this.prefix}RequestFullScreen`]()},e.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[`${this.prefix}CancelFullScreen`]()}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){e.supportsFullScreen&&e.requestFullScreen(this)})}),window.fullScreenApi=e})(),jQuery.fn.allBut=function(e){let t=jQuery(),r=jQuery(e||"body").children();for(;r.length>0;){const e=r.first();r=r.slice(1),e.filter(this).length!==this.length&&(e.has(this).length>0?r=r.add(e.children()):"none"!==e.css("display")&&(t=t.add(e)))}return t},dotclear.ready(()=>{dotclear.mergeDeep(dotclear,dotclear.getData("zenedit")),jsToolBar.prototype.elements.zenEditSpace={type:"space",format:{wysiwyg:!0,wiki:!0,xhtml:!0,markdown:!0}},jsToolBar.prototype.elements.zenEdit={type:"button",title:"Zen",fn:{}},jsToolBar.prototype.elements.zenEdit.context="post",jsToolBar.prototype.elements.zenEdit.icon=dotclear.zenEdit.icon,jsToolBar.prototype.elements.zenEdit.icon_dark=dotclear.zenEdit.icon_dark,jsToolBar.prototype.elements.zenEdit.fn.wiki=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.xhtml=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.wysiwyg=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.markdown=()=>dotclear.zenEdit.switch(),dotclear.zenEdit.switch=()=>{const e=document.querySelector("body"),t=document.getElementById("wrapper"),r=document.getElementById("main"),n=document.getElementById("content"),o=document.getElementById("entry-wrapper"),l=document.getElementById("entry-content"),c=document.querySelector("button.jstb_zenEdit");if(dotclear.zenEdit.zenMode)return""!==dotclear.zenEdit.background&&(e.style.backgroundImage="none"),l.style.marginTop=dotclear.zenEdit.prop.container_mt,l.style.marginLeft=dotclear.zenEdit.prop.container_ml,l.style.marginRight=dotclear.zenEdit.prop.container_mr,e.style.color=dotclear.zenEdit.prop.body_tc,e.style.backgroundColor=dotclear.zenEdit.prop.body_bc,t.style.backgroundColor=dotclear.zenEdit.prop.wrapper_bc,t.style.backgroundImage=dotclear.zenEdit.prop.wrapper_bi,n.style.backgroundColor=dotclear.zenEdit.prop.page_bc,r.style.backgroundColor=dotclear.zenEdit.prop.main_bc,r.style.backgroundImage=dotclear.zenEdit.prop.main_bi,dotclear.zenEdit.stack.show(),jsToolBar.prototype.elements.zenEdit.title=dotclear.msg.zenEdit.show,c.setAttribute("title",dotclear.msg.zenEdit.show),dotclear.zenEdit.zenMode=!1,void(dotclear.zenEdit.fullScreen&&fullScreenApi.supportsFullScreen&&fullScreenApi.isFullScreen&&fullScreenApi.cancelFullScreen(document.documentElement));dotclear.zenEdit.prop={body_tc:e.style.color,body_bc:e.style.backgroundColor,page_bc:n.style.backgroundColor,main_bc:r.style.backgroundColor,main_bi:r.style.backgroundImage,container_mt:l.style.marginTop,container_ml:l.style.marginLeft,container_mr:l.style.marginRight,hide_mm:t.classList.contains("hide-mm"),wrapper_bc:t.style.backgroundColor,wrapper_bi:t.style.backgroundImage},dotclear.zenEdit.color="rgb(101,101,101)",""!==dotclear.zenEdit.background&&(e.style.backgroundImage=`url(${dotclear.zenEdit.base_url}${dotclear.zenEdit.background})`,"dark/"===dotclear.zenEdit.background.substring(0,5)&&(dotclear.zenEdit.color="rgb(241,241,241)")),l.style.marginTop="3em",dotclear.zenEdit.smallMargins?(l.style.marginLeft=dotclear.zenEdit.prop.hide_mm?o.style.marginRight:"-13em",l.style.marginRight="0"):(l.style.marginLeft=dotclear.zenEdit.prop.hide_mm?"14.5em":"1em",l.style.marginRight="14.5em"),e.style.color=dotclear.zenEdit.color,e.style.backgroundColor="rgb(248,248,248)",t.style.backgroundColor="transparent",t.style.backgroundImage="none",n.style.backgroundColor="transparent",r.style.backgroundColor="transparent",r.style.backgroundImage="none",dotclear.zenEdit.stack=jQuery(l).allBut(),dotclear.zenEdit.stack.hide(),jsToolBar.prototype.elements.zenEdit.title=dotclear.msg.zenEdit.hide,c.setAttribute("title",dotclear.msg.zenEdit.hide),dotclear.zenEdit.zenMode=!0,dotclear.zenEdit.fullScreen&&fullScreenApi.supportsFullScreen&&fullScreenApi.requestFullScreen(document.documentElement)},jsToolBar.prototype.elements.zenEdit.title=dotclear.zenEdit.zenMode?dotclear.msg.zenEdit.hide:dotclear.msg.zenEdit.show});
