"use strict";(()=>{const e={supportsFullScreen:!1,isFullScreen:()=>!1,requestFullScreen:()=>{},cancelFullScreen:()=>{},fullScreenEventName:"",prefix:""},t="webkit moz o ms khtml".split(" ");if(void 0===document.cancelFullScreen){for(let r=0,n=t.length;r<n;r++)if(e.prefix=t[r],void 0!==document[`${e.prefix}CancelFullScreen`]){e.supportsFullScreen=!0;break}}else e.supportsFullScreen=!0;e.supportsFullScreen&&(e.fullScreenEventName=`${e.prefix}fullscreenchange`,e.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[`${this.prefix}FullScreen`]}},e.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[`${this.prefix}RequestFullScreen`]()},e.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[`${this.prefix}CancelFullScreen`]()}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each((function(){e.supportsFullScreen&&e.requestFullScreen(this)}))}),window.fullScreenApi=e})(),$.fn.allBut=function(e){let t=$(),r=$(e||"body").children();for(;r.length>0;){const e=r.first();r=r.slice(1),e.filter(this).length!=this.length&&(e.has(this).length>0?r=r.add(e.children()):"none"!=e.css("display")&&(t=t.add(e)))}return t},dotclear.ready((()=>{dotclear.mergeDeep(dotclear,dotclear.getData("zenedit")),jsToolBar.prototype.elements.zenEditSpace={type:"space",format:{wysiwyg:!0,wiki:!0,xhtml:!0,markdown:!0}},jsToolBar.prototype.elements.zenEdit={type:"button",title:"Zen",fn:{}},jsToolBar.prototype.elements.zenEdit.context="post",jsToolBar.prototype.elements.zenEdit.icon=dotclear.zenEdit.icon,jsToolBar.prototype.elements.zenEdit.fn.wiki=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.xhtml=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.wysiwyg=()=>dotclear.zenEdit.switch(),jsToolBar.prototype.elements.zenEdit.fn.markdown=()=>dotclear.zenEdit.switch(),dotclear.zenEdit.switch=()=>{const e=$("#wrapper"),t=$("#main"),r=$("#content"),n=$("#entry-wrapper"),o=$("div#entry-content");if(0==dotclear.zenEdit.mode)return dotclear.zenEdit.prop={body_tc:$("body").css("color"),body_bc:$("body").css("background-color"),page_bc:r.css("background-color"),main_bc:t.css("background-color"),main_bi:t.css("background-image"),container_mt:o.css("margin-top"),container_ml:o.css("margin-left"),container_mr:o.css("margin-right"),hide_mm:e.hasClass("hide-mm"),wrapper_bc:e.css("background-color"),wrapper_bi:e.css("background-image")},dotclear.zenEdit.color="rgb(101,101,101)",""!==dotclear.zenEdit.background&&($("body").css("background-image",`url(${dotclear.zenEdit.base_url}${dotclear.zenEdit.background})`),"dark/"==dotclear.zenEdit.background.substring(0,4)&&(dotclear.zenEdit.color="rgb(241,241,241)")),o.css("margin-top","3em"),"1"==dotclear.zenEdit.smallMargins?(o.css("margin-left",dotclear.zenEdit.prop.hide_mm?n.css("margin-right"):"-13em"),o.css("margin-right","0")):(o.css("margin-left",dotclear.zenEdit.prop.hide_mm?"14.5em":"1em"),o.css("margin-right","14.5em")),$("body").css("color",dotclear.zenEdit.color).css("background-color","rgb(248,248,248)"),e.css("background-color","transparent").css("background-image","none"),r.css("background-color","transparent"),t.css("background-color","transparent").css("background-image","none"),dotclear.zenEdit.stack=o.allBut(),dotclear.zenEdit.stack.hide(),jsToolBar.prototype.elements.zenEdit.title=dotclear.msg.zenEdit.hide,$("button.jstb_zenEdit").attr("title",dotclear.msg.zenEdit.hide),dotclear.zenEdit.mode=1,void("1"==dotclear.zenEdit.fullScreen&&fullScreenApi.supportsFullScreen&&fullScreenApi.requestFullScreen(document.documentElement));""!==dotclear.zenEdit.background&&$("body").css("background-image","none"),o.css("margin-top",dotclear.zenEdit.prop.container_mt),o.css("margin-left",dotclear.zenEdit.prop.container_ml),o.css("margin-right",dotclear.zenEdit.prop.container_mr),$("body").css("color",dotclear.zenEdit.prop.body_tc).css("background-color",dotclear.zenEdit.prop.body_bc),e.css("background-color",dotclear.zenEdit.prop.wrapper_bc).css("background-image",dotclear.zenEdit.prop.wrapper_bi),r.css("background-color",dotclear.zenEdit.prop.page_bc),t.css("background-color",dotclear.zenEdit.prop.main_bc).css("background-image",dotclear.zenEdit.prop.main_bi),dotclear.zenEdit.stack.show(),jsToolBar.prototype.elements.zenEdit.title=dotclear.msg.zenEdit.show,$("button.jstb_zenEdit").attr("title",dotclear.msg.zenEdit.show),dotclear.zenEdit.mode=0,"1"==dotclear.zenEdit.fullScreen&&fullScreenApi.supportsFullScreen&&fullScreenApi.isFullScreen&&fullScreenApi.cancelFullScreen(document.documentElement)},jsToolBar.prototype.elements.zenEdit.title=0==dotclear.zenEdit.mode?dotclear.msg.zenEdit.show:dotclear.msg.zenEdit.hide}));
